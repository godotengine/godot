<?xml version="1.0" encoding="UTF-8" ?>
<class name="AudioEffectCaptureInstance" inherits="AudioEffectInstance" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../class.xsd">
	<brief_description>
		Captures audio from an audio bus, on a specific channel, in real-time.
	</brief_description>
	<description>
		AudioEffectCaptureInstance is an instance of AudioEffectCapture which copies all audio frames from a specific channel of the attached audio effect bus into its internal ring buffer.
		Access to instances of this class can be obtained with [method AudioServer.get_bus_effect_instance]. The parent AudioEffectCapture object mirrors the AudioEffectCaptureInstance created for channel 0, so method calls on the parent are passed straight through to the channel 0 instance.
		Application code may consume these audio frames from this ring buffer using [method get_buffer] and process it as needed, for example to capture data from an [AudioStreamMicrophone], implement application-defined effects, or to transmit audio over the network. When capturing audio data from a microphone, the format of the samples will be stereo 32-bit floating-point PCM.
		Unlike [AudioEffectRecord] or [AudioEffectRecordInstance], this effect only returns the raw audio samples instead of encoding them into an [AudioStream].
		[b]Note:[/b] [member ProjectSettings.audio/driver/enable_input] must be [code]true[/code] for audio input to work. See also that setting's description for caveats related to permissions and operating system privacy settings.
	</description>
	<tutorials>
		<link title="Audio buses">$DOCS_URL/tutorials/audio/audio_buses.html</link>
	</tutorials>
	<methods>
		<method name="can_get_buffer" qualifiers="const">
			<return type="bool" />
			<param index="0" name="frames" type="int" />
			<description>
				Returns [code]true[/code] if at least [param frames] audio frames are available to read in the internal ring buffer.
			</description>
		</method>
		<method name="clear_buffer">
			<return type="void" />
			<description>
				Clears the internal ring buffer.
				[b]Note:[/b] Calling this during a capture can cause the loss of samples which causes popping in the playback.
			</description>
		</method>
		<method name="get_buffer">
			<return type="PackedVector2Array" />
			<param index="0" name="frames" type="int" />
			<description>
				Gets the next [param frames] audio samples from the internal ring buffer.
				Returns a [PackedVector2Array] containing exactly [param frames] audio samples if available, or an empty [PackedVector2Array] if insufficient data was available.
				The samples are signed floating-point PCM between [code]-1[/code] and [code]1[/code]. You will have to scale them if you want to use them as 8 or 16-bit integer samples. ([code]v = 0x7fff * samples[0].x[/code])
			</description>
		</method>
		<method name="get_buffer_length_frames" qualifiers="const">
			<return type="int" />
			<description>
				Returns the total size of the internal ring buffer in frames.
			</description>
		</method>
		<method name="get_discarded_frames" qualifiers="const">
			<return type="int" />
			<description>
				Returns the number of audio frames discarded from the audio bus due to full buffer.
			</description>
		</method>
		<method name="get_frames_available" qualifiers="const">
			<return type="int" />
			<description>
				Returns the number of frames available to read using [method get_buffer].
			</description>
		</method>
		<method name="get_pushed_frames" qualifiers="const">
			<return type="int" />
			<description>
				Returns the number of audio frames inserted from the audio bus.
			</description>
		</method>
	</methods>
	<members>
		<member name="buffer_length" type="float" setter="set_buffer_length" getter="get_buffer_length">
			Length of the internal ring buffer, in seconds. Initialized to buffer length of parent [AudioEffectCapture]. Setting the buffer length will have no effect if already initialized.
		</member>
	</members>
</class>
