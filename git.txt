 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/.gitattributes b/.gitattributes
index 943d6b5d7cec34e3a76838c40425b00ce5a49738..ef328114e39fbb76bfbb81c3c16f3ecb722834da 100644
--- a/.gitattributes
+++ b/.gitattributes
@@ -1,23 +1,24 @@
 # Properly detect languages on Github
 *.h linguist-language=C++
 *.inc linguist-language=C++
 thirdparty/* linguist-vendored
 
 # Normalize EOL for all files that Git considers text files
 * text=auto eol=lf
 # Except for Windows-only / Visual Studio files
 *.bat eol=crlf
 *.sln eol=crlf
 *.csproj eol=crlf
 misc/msvs/* eol=crlf
 # And some test files where the EOL matters
 *.test.txt -text
 
 # The above only works properly for Git 2.10+, so for older versions
 # we need to manually list the binary files we don't want modified.
 *.icns binary
 *.ico binary
 *.jar binary
 *.png binary
 *.ttf binary
 *.tza binary
+godot/** -diff
diff --git a/.gitmodules b/.gitmodules
new file mode 100644
index 0000000000000000000000000000000000000000..63c42a8987380d4df49b9faea003ce5928f35dc0
--- /dev/null
+++ b/.gitmodules
@@ -0,0 +1,3 @@
+[submodule "godot"]
+	path = godot
+	url = https://github.com/godotengine/godot.git
diff --git a/gdverify/CMakeLists.txt b/gdverify/CMakeLists.txt
new file mode 100644
index 0000000000000000000000000000000000000000..e6d2e5dd7a82aad392facb722044694c17417abe
--- /dev/null
+++ b/gdverify/CMakeLists.txt
@@ -0,0 +1,16 @@
+cmake_minimum_required(VERSION 3.12)
+project(gdverify)
+
+option(GODOT_SRC_DIR "Path to Godot source" "${CMAKE_CURRENT_SOURCE_DIR}/../godot")
+
+add_compile_definitions(TOOLS_ENABLED=0 DEBUG_ENABLED=0)
+
+include_directories(${CMAKE_CURRENT_SOURCE_DIR}/include ${GODOT_SRC_DIR})
+
+add_library(gdscript STATIC
+    ${GODOT_SRC_DIR}/modules/gdscript/gdscript_parser.cpp
+    ${GODOT_SRC_DIR}/modules/gdscript/gdscript_tokenizer.cpp
+)
+
+add_executable(gdverify src/main.cpp)
+target_link_libraries(gdverify gdscript)
diff --git a/gdverify/README.md b/gdverify/README.md
new file mode 100644
index 0000000000000000000000000000000000000000..cf1e75b3847f5a326f9ccd20e6595e4a68429001
--- /dev/null
+++ b/gdverify/README.md
@@ -0,0 +1,19 @@
+# gdverify
+
+A tiny tool to parse GDScript files using Godot's built-in parser.
+
+## Build
+
+```sh
+mkdir build && cd build
+cmake ../gdverify -DGODOT_SRC_DIR=../godot -DCMAKE_BUILD_TYPE=Release
+cmake --build . --parallel
+```
+
+## Run
+
+```sh
+./gdverify path/to/script.gd
+```
+
+Exit code `0` means success, `65` indicates a parse error.
diff --git a/gdverify/include/core/disabled_classes.gen.h b/gdverify/include/core/disabled_classes.gen.h
new file mode 100644
index 0000000000000000000000000000000000000000..23a6c156506624277cb72f275873c9476102c18d
--- /dev/null
+++ b/gdverify/include/core/disabled_classes.gen.h
@@ -0,0 +1,31 @@
+/**************************************************************************/
+/*  disabled_classes.gen.h                                                */
+/**************************************************************************/
+/*                         This file is part of:                          */
+/*                             GODOT ENGINE                               */
+/*                        https://godotengine.org                         */
+/**************************************************************************/
+/* Copyright (c) 2014-present Godot Engine contributors (see AUTHORS.md). */
+/* Copyright (c) 2007-2014 Juan Linietsky, Ariel Manzur.                  */
+/*                                                                        */
+/* Permission is hereby granted, free of charge, to any person obtaining  */
+/* a copy of this software and associated documentation files (the        */
+/* "Software"), to deal in the Software without restriction, including    */
+/* without limitation the rights to use, copy, modify, merge, publish,    */
+/* distribute, sublicense, and/or sell copies of the Software, and to     */
+/* permit persons to whom the Software is furnished to do so, subject to  */
+/* the following conditions:                                              */
+/*                                                                        */
+/* The above copyright notice and this permission notice shall be         */
+/* included in all copies or substantial portions of the Software.        */
+/*                                                                        */
+/* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,        */
+/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF     */
+/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. */
+/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY   */
+/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,   */
+/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE      */
+/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 */
+/**************************************************************************/
+
+#pragma once
diff --git a/gdverify/include/core/extension/ext_wrappers.gen.inc b/gdverify/include/core/extension/ext_wrappers.gen.inc
new file mode 100644
index 0000000000000000000000000000000000000000..8223defe5f7dd32c72f530f032694a21dbc2a6f0
--- /dev/null
+++ b/gdverify/include/core/extension/ext_wrappers.gen.inc
@@ -0,0 +1,31 @@
+/**************************************************************************/
+/*  ext_wrappers.gen.inc                                                  */
+/**************************************************************************/
+/*                         This file is part of:                          */
+/*                             GODOT ENGINE                               */
+/*                        https://godotengine.org                         */
+/**************************************************************************/
+/* Copyright (c) 2014-present Godot Engine contributors (see AUTHORS.md). */
+/* Copyright (c) 2007-2014 Juan Linietsky, Ariel Manzur.                  */
+/*                                                                        */
+/* Permission is hereby granted, free of charge, to any person obtaining  */
+/* a copy of this software and associated documentation files (the        */
+/* "Software"), to deal in the Software without restriction, including    */
+/* without limitation the rights to use, copy, modify, merge, publish,    */
+/* distribute, sublicense, and/or sell copies of the Software, and to     */
+/* permit persons to whom the Software is furnished to do so, subject to  */
+/* the following conditions:                                              */
+/*                                                                        */
+/* The above copyright notice and this permission notice shall be         */
+/* included in all copies or substantial portions of the Software.        */
+/*                                                                        */
+/* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,        */
+/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF     */
+/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. */
+/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY   */
+/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,   */
+/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE      */
+/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 */
+/**************************************************************************/
+
+#pragma once
diff --git a/gdverify/include/core/object/gdvirtual.gen.inc b/gdverify/include/core/object/gdvirtual.gen.inc
new file mode 100644
index 0000000000000000000000000000000000000000..2f3a43312aebed46721bd894cbf67083f355af5b
--- /dev/null
+++ b/gdverify/include/core/object/gdvirtual.gen.inc
@@ -0,0 +1,86 @@
+/**************************************************************************/
+/*  gdvirtual.gen.inc                                                     */
+/**************************************************************************/
+/*                         This file is part of:                          */
+/*                             GODOT ENGINE                               */
+/*                        https://godotengine.org                         */
+/**************************************************************************/
+/* Copyright (c) 2014-present Godot Engine contributors (see AUTHORS.md). */
+/* Copyright (c) 2007-2014 Juan Linietsky, Ariel Manzur.                  */
+/*                                                                        */
+/* Permission is hereby granted, free of charge, to any person obtaining  */
+/* a copy of this software and associated documentation files (the        */
+/* "Software"), to deal in the Software without restriction, including    */
+/* without limitation the rights to use, copy, modify, merge, publish,    */
+/* distribute, sublicense, and/or sell copies of the Software, and to     */
+/* permit persons to whom the Software is furnished to do so, subject to  */
+/* the following conditions:                                              */
+/*                                                                        */
+/* The above copyright notice and this permission notice shall be         */
+/* included in all copies or substantial portions of the Software.        */
+/*                                                                        */
+/* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,        */
+/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF     */
+/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. */
+/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY   */
+/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,   */
+/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE      */
+/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 */
+/**************************************************************************/
+
+#pragma once
+
+#define GDVIRTUAL0(...)
+#define GDVIRTUAL1(...)
+#define GDVIRTUAL2(...)
+#define GDVIRTUAL3(...)
+#define GDVIRTUAL4(...)
+#define GDVIRTUAL5(...)
+#define GDVIRTUAL6(...)
+#define GDVIRTUAL7(...)
+#define GDVIRTUAL8(...)
+#define GDVIRTUAL9(...)
+#define GDVIRTUAL0R(...)
+#define GDVIRTUAL1R(...)
+#define GDVIRTUAL2R(...)
+#define GDVIRTUAL3R(...)
+#define GDVIRTUAL4R(...)
+#define GDVIRTUAL5R(...)
+#define GDVIRTUAL6R(...)
+#define GDVIRTUAL7R(...)
+#define GDVIRTUAL8R(...)
+#define GDVIRTUAL9R(...)
+#define GDVIRTUAL0RC(...)
+#define GDVIRTUAL1RC(...)
+#define GDVIRTUAL2RC(...)
+#define GDVIRTUAL3RC(...)
+#define GDVIRTUAL4RC(...)
+#define GDVIRTUAL5RC(...)
+#define GDVIRTUAL6RC(...)
+#define GDVIRTUAL7RC(...)
+#define GDVIRTUAL8RC(...)
+#define GDVIRTUAL1C(...)
+#define GDVIRTUAL2C(...)
+#define GDVIRTUAL3C(...)
+#define GDVIRTUAL4C(...)
+#define GDVIRTUAL5C(...)
+#define GDVIRTUAL6C(...)
+#define GDVIRTUAL7C(...)
+#define GDVIRTUAL8C(...)
+#define EXBIND0(...)
+#define EXBIND1(...)
+#define EXBIND2(...)
+#define EXBIND3(...)
+#define EXBIND4(...)
+#define EXBIND5(...)
+#define EXBIND6(...)
+#define EXBIND7(...)
+#define EXBIND0RC(...)
+#define EXBIND1RC(...)
+#define EXBIND2RC(...)
+#define EXBIND3RC(...)
+#define EXBIND4RC(...)
+#define EXBIND5RC(...)
+#define EXBIND6RC(...)
+#define EXBIND7RC(...)
+#define EXBIND8RC(...)
diff --git a/gdverify/include/godot_defs.h b/gdverify/include/godot_defs.h
new file mode 100644
index 0000000000000000000000000000000000000000..ca9df0342fb039f2d8a4969002161180039fd53e
--- /dev/null
+++ b/gdverify/include/godot_defs.h
@@ -0,0 +1,39 @@
+/**************************************************************************/
+/*  godot_defs.h                                                          */
+/**************************************************************************/
+/*                         This file is part of:                          */
+/*                             GODOT ENGINE                               */
+/*                        https://godotengine.org                         */
+/**************************************************************************/
+/* Copyright (c) 2014-present Godot Engine contributors (see AUTHORS.md). */
+/* Copyright (c) 2007-2014 Juan Linietsky, Ariel Manzur.                  */
+/*                                                                        */
+/* Permission is hereby granted, free of charge, to any person obtaining  */
+/* a copy of this software and associated documentation files (the        */
+/* "Software"), to deal in the Software without restriction, including    */
+/* without limitation the rights to use, copy, modify, merge, publish,    */
+/* distribute, sublicense, and/or sell copies of the Software, and to     */
+/* permit persons to whom the Software is furnished to do so, subject to  */
+/* the following conditions:                                              */
+/*                                                                        */
+/* The above copyright notice and this permission notice shall be         */
+/* included in all copies or substantial portions of the Software.        */
+/*                                                                        */
+/* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,        */
+/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF     */
+/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. */
+/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY   */
+/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,   */
+/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE      */
+/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 */
+/**************************************************************************/
+
+#pragma once
+
+#define GDSCRIPT_TOKEN_MAX_LEN 256
+
+namespace Math {
+inline bool is_power_of_two(int x) {
+	return x && ((x & (x - 1)) == 0);
+}
+} //namespace Math
diff --git a/gdverify/include/mini_godot_core.h b/gdverify/include/mini_godot_core.h
new file mode 100644
index 0000000000000000000000000000000000000000..364ed5a80896160c8e39ada0a710d9c6cb0536ab
--- /dev/null
+++ b/gdverify/include/mini_godot_core.h
@@ -0,0 +1,34 @@
+/**************************************************************************/
+/*  mini_godot_core.h                                                     */
+/**************************************************************************/
+/*                         This file is part of:                          */
+/*                             GODOT ENGINE                               */
+/*                        https://godotengine.org                         */
+/**************************************************************************/
+/* Copyright (c) 2014-present Godot Engine contributors (see AUTHORS.md). */
+/* Copyright (c) 2007-2014 Juan Linietsky, Ariel Manzur.                  */
+/*                                                                        */
+/* Permission is hereby granted, free of charge, to any person obtaining  */
+/* a copy of this software and associated documentation files (the        */
+/* "Software"), to deal in the Software without restriction, including    */
+/* without limitation the rights to use, copy, modify, merge, publish,    */
+/* distribute, sublicense, and/or sell copies of the Software, and to     */
+/* permit persons to whom the Software is furnished to do so, subject to  */
+/* the following conditions:                                              */
+/*                                                                        */
+/* The above copyright notice and this permission notice shall be         */
+/* included in all copies or substantial portions of the Software.        */
+/*                                                                        */
+/* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,        */
+/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF     */
+/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. */
+/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY   */
+/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,   */
+/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE      */
+/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 */
+/**************************************************************************/
+
+#pragma once
+
+#include <cstdio>
+#include <cstdlib>
diff --git a/gdverify/include/platform_config.h b/gdverify/include/platform_config.h
new file mode 100644
index 0000000000000000000000000000000000000000..73d4c7f94e1d2c0614468529eee2f0849365be0b
--- /dev/null
+++ b/gdverify/include/platform_config.h
@@ -0,0 +1,32 @@
+/**************************************************************************/
+/*  platform_config.h                                                     */
+/**************************************************************************/
+/*                         This file is part of:                          */
+/*                             GODOT ENGINE                               */
+/*                        https://godotengine.org                         */
+/**************************************************************************/
+/* Copyright (c) 2014-present Godot Engine contributors (see AUTHORS.md). */
+/* Copyright (c) 2007-2014 Juan Linietsky, Ariel Manzur.                  */
+/*                                                                        */
+/* Permission is hereby granted, free of charge, to any person obtaining  */
+/* a copy of this software and associated documentation files (the        */
+/* "Software"), to deal in the Software without restriction, including    */
+/* without limitation the rights to use, copy, modify, merge, publish,    */
+/* distribute, sublicense, and/or sell copies of the Software, and to     */
+/* permit persons to whom the Software is furnished to do so, subject to  */
+/* the following conditions:                                              */
+/*                                                                        */
+/* The above copyright notice and this permission notice shall be         */
+/* included in all copies or substantial portions of the Software.        */
+/*                                                                        */
+/* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,        */
+/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF     */
+/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. */
+/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY   */
+/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,   */
+/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE      */
+/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 */
+/**************************************************************************/
+
+#pragma once
+#include "platform/linuxbsd/platform_config.h"
diff --git a/gdverify/samples/error.gd b/gdverify/samples/error.gd
new file mode 100644
index 0000000000000000000000000000000000000000..52df7f1b6a08c3a7ff78c1e9c8f4642e6b809e6a
--- /dev/null
+++ b/gdverify/samples/error.gd
@@ -0,0 +1,2 @@
+func _ready(
+    print("Missing closing")
diff --git a/gdverify/samples/hello.gd b/gdverify/samples/hello.gd
new file mode 100644
index 0000000000000000000000000000000000000000..0c117f4f5acaf111fb10b17f6de04a6848262a25
--- /dev/null
+++ b/gdverify/samples/hello.gd
@@ -0,0 +1,2 @@
+func _ready():
+    print("Hello")
diff --git a/gdverify/src/main.cpp b/gdverify/src/main.cpp
new file mode 100644
index 0000000000000000000000000000000000000000..af9b5e99bd6264ad7180118c9fc5d89bf661b101
--- /dev/null
+++ b/gdverify/src/main.cpp
@@ -0,0 +1,57 @@
+/**************************************************************************/
+/*  main.cpp                                                              */
+/**************************************************************************/
+/*                         This file is part of:                          */
+/*                             GODOT ENGINE                               */
+/*                        https://godotengine.org                         */
+/**************************************************************************/
+/* Copyright (c) 2014-present Godot Engine contributors (see AUTHORS.md). */
+/* Copyright (c) 2007-2014 Juan Linietsky, Ariel Manzur.                  */
+/*                                                                        */
+/* Permission is hereby granted, free of charge, to any person obtaining  */
+/* a copy of this software and associated documentation files (the        */
+/* "Software"), to deal in the Software without restriction, including    */
+/* without limitation the rights to use, copy, modify, merge, publish,    */
+/* distribute, sublicense, and/or sell copies of the Software, and to     */
+/* permit persons to whom the Software is furnished to do so, subject to  */
+/* the following conditions:                                              */
+/*                                                                        */
+/* The above copyright notice and this permission notice shall be         */
+/* included in all copies or substantial portions of the Software.        */
+/*                                                                        */
+/* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,        */
+/* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF     */
+/* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. */
+/* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY   */
+/* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,   */
+/* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE      */
+/* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.                 */
+/**************************************************************************/
+
+#include "godot_defs.h"
+#include "mini_godot_core.h"
+
+#include "../godot/modules/gdscript/gdscript_parser.h"
+#include "../godot/modules/gdscript/gdscript_tokenizer_buffer.h"
+
+#include <fstream>
+#include <sstream>
+
+int main(int argc, char **argv) {
+	if (argc != 2) {
+		fprintf(stderr, "Usage: %s <file.gd>\n", argv[0]);
+		return 1;
+	}
+	std::ifstream f(argv[1]);
+	if (!f) {
+		fprintf(stderr, "Cannot open %s\n", argv[1]);
+		return 1;
+	}
+	std::stringstream ss;
+	ss << f.rdbuf();
+	String src = ss.str().c_str();
+
+	GDScriptParser parser;
+	Error err = parser.parse(src, argv[1], false);
+	return (err == OK) ? 0 : 65;
+}
diff --git a/godot b/godot
new file mode 160000
index 0000000000000000000000000000000000000000..5abed52fd9d99c4aab7d8c62d505f9ad618e4533
--- /dev/null
+++ b/godot
@@ -0,0 +1 @@
+Subproject commit 5abed52fd9d99c4aab7d8c62d505f9ad618e4533
 
EOF
)
