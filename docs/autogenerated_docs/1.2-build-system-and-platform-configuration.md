# Build System

<details>
<summary>Relevant source files</summary>

The following files were used as context for generating this wiki page:

- [SConstruct](https://github.com/godotengine/godot/blob/4219ce91/SConstruct)
- [core/SCsub](https://github.com/godotengine/godot/blob/4219ce91/core/SCsub)
- [editor/SCsub](https://github.com/godotengine/godot/blob/4219ce91/editor/SCsub)
- [editor/icons/SCsub](https://github.com/godotengine/godot/blob/4219ce91/editor/icons/SCsub)
- [main/SCsub](https://github.com/godotengine/godot/blob/4219ce91/main/SCsub)
- [methods.py](https://github.com/godotengine/godot/blob/4219ce91/methods.py)
- [modules/SCsub](https://github.com/godotengine/godot/blob/4219ce91/modules/SCsub)
- [modules/gdscript/editor/script_templates/SCsub](https://github.com/godotengine/godot/blob/4219ce91/modules/gdscript/editor/script_templates/SCsub)
- [modules/modules_builders.py](https://github.com/godotengine/godot/blob/4219ce91/modules/modules_builders.py)
- [modules/mono/editor/script_templates/SCsub](https://github.com/godotengine/godot/blob/4219ce91/modules/mono/editor/script_templates/SCsub)
- [platform/SCsub](https://github.com/godotengine/godot/blob/4219ce91/platform/SCsub)
- [platform/android/detect.py](https://github.com/godotengine/godot/blob/4219ce91/platform/android/detect.py)
- [platform/ios/detect.py](https://github.com/godotengine/godot/blob/4219ce91/platform/ios/detect.py)
- [platform/linuxbsd/detect.py](https://github.com/godotengine/godot/blob/4219ce91/platform/linuxbsd/detect.py)
- [platform/macos/detect.py](https://github.com/godotengine/godot/blob/4219ce91/platform/macos/detect.py)
- [platform/web/detect.py](https://github.com/godotengine/godot/blob/4219ce91/platform/web/detect.py)
- [platform/windows/SCsub](https://github.com/godotengine/godot/blob/4219ce91/platform/windows/SCsub)
- [platform/windows/detect.py](https://github.com/godotengine/godot/blob/4219ce91/platform/windows/detect.py)
- [platform_methods.py](https://github.com/godotengine/godot/blob/4219ce91/platform_methods.py)
- [scene/theme/icons/SCsub](https://github.com/godotengine/godot/blob/4219ce91/scene/theme/icons/SCsub)

</details>



The Godot Engine uses SCons as its build system to handle cross-platform compilation, module management, and build configuration. This document covers the architecture and implementation of the build system, including platform detection, module discovery, source file organization, and build orchestration.

For information about engine initialization after the build process, see [Engine Initialization and Core Systems](#1.1).

## Build System Architecture

The build system is orchestrated through SCons with a hierarchical structure of build scripts that handle different aspects of compilation.

```mermaid
graph TB
    SConstruct["SConstruct<br/>Main Build Entry Point"]
    methods["methods.py<br/>Build Utilities"]
    platform_detect["platform/*/detect.py<br/>Platform Detection"]
    scsub_files["*/SCsub<br/>Component Build Scripts"]
    
    subgraph "Platform Support"
        windows_detect["platform/windows/detect.py"]
        linux_detect["platform/linuxbsd/detect.py"] 
        macos_detect["platform/macos/detect.py"]
        android_detect["platform/android/detect.py"]
        web_detect["platform/web/detect.py"]
        ios_detect["platform/ios/detect.py"]
    end
    
    subgraph "Core Components"
        core_scsub["core/SCsub"]
        main_scsub["main/SCsub"]
        editor_scsub["editor/SCsub"]
        modules_scsub["modules/SCsub"]
        platform_scsub["platform/SCsub"]
    end
    
    SConstruct --> methods
    SConstruct --> platform_detect
    SConstruct --> scsub_files
    
    platform_detect --> windows_detect
    platform_detect --> linux_detect
    platform_detect --> macos_detect
    platform_detect --> android_detect
    platform_detect --> web_detect
    platform_detect --> ios_detect
    
    scsub_files --> core_scsub
    scsub_files --> main_scsub
    scsub_files --> editor_scsub
    scsub_files --> modules_scsub
    scsub_files --> platform_scsub
```

Sources: [SConstruct:1-1000](https://github.com/godotengine/godot/blob/4219ce91/SConstruct#L1-L1000), [methods.py:1-900](https://github.com/godotengine/godot/blob/4219ce91/methods.py#L1-L900), [platform/windows/detect.py:1-300](https://github.com/godotengine/godot/blob/4219ce91/platform/windows/detect.py#L1-L300), [platform/linuxbsd/detect.py:1-500](https://github.com/godotengine/godot/blob/4219ce91/platform/linuxbsd/detect.py#L1-L500), [core/SCsub:1-241](https://github.com/godotengine/godot/blob/4219ce91/core/SCsub#L1-L241), [editor/SCsub:1-116](https://github.com/godotengine/godot/blob/4219ce91/editor/SCsub#L1-L116), [modules/SCsub:1-64](https://github.com/godotengine/godot/blob/4219ce91/modules/SCsub#L1-L64)

## Platform Detection and Configuration

The build system automatically detects the target platform and configures appropriate build tools and settings through a standardized interface.

```mermaid
graph TB
    subgraph "Platform Detection Flow"
        detect_platform["SConstruct<br/>Platform Detection<br/>Lines 331-375"]
        platform_list["platform_list<br/>Available Platforms"]
        can_build["detect.can_build()<br/>Platform Availability Check"]
        get_tools["detect.get_tools()<br/>Toolchain Selection"]
        get_opts["detect.get_opts()<br/>Platform Options"]
        configure["detect.configure()<br/>Environment Setup"]
    end
    
    subgraph "Platform Modules"
        windows_module["Windows Platform<br/>MSVC/MinGW Detection"]
        linux_module["LinuxBSD Platform<br/>GCC/Clang Detection"]
        macos_module["macOS Platform<br/>Xcode Tools Detection"]
        android_module["Android Platform<br/>NDK Configuration"]
        web_module["Web Platform<br/>Emscripten Detection"]
        ios_module["iOS Platform<br/>Xcode/OSXCross Detection"]
    end
    
    detect_platform --> platform_list
    platform_list --> can_build
    can_build --> get_tools
    get_tools --> get_opts
    get_opts --> configure
    
    configure --> windows_module
    configure --> linux_module
    configure --> macos_module
    configure --> android_module
    configure --> web_module
    configure --> ios_module
```

Each platform provides standardized functions for build integration:

| Function | Purpose | Example Implementation |
|----------|---------|----------------------|
| `can_build()` | Check if platform can be built on current host | [platform/windows/detect.py:47-59]() |
| `get_opts()` | Define platform-specific build options | [platform/windows/detect.py:162-218]() |
| `get_tools()` | Select appropriate compiler toolchain | [platform/windows/detect.py:150-159]() |
| `configure(env)` | Setup build environment and flags | [platform/windows/detect.py:280-563]() |

Sources: [SConstruct:331-375](https://github.com/godotengine/godot/blob/4219ce91/SConstruct#L331-L375), [platform/windows/detect.py:47-218](https://github.com/godotengine/godot/blob/4219ce91/platform/windows/detect.py#L47-L218), [platform/linuxbsd/detect.py:17-26](https://github.com/godotengine/godot/blob/4219ce91/platform/linuxbsd/detect.py#L17-L26), [platform/android/detect.py:87-248](https://github.com/godotengine/godot/blob/4219ce91/platform/android/detect.py#L87-L248), [platform/web/detect.py:29-348](https://github.com/godotengine/godot/blob/4219ce91/platform/web/detect.py#L29-L348), [platform/ios/detect.py:16-181](https://github.com/godotengine/godot/blob/4219ce91/platform/ios/detect.py#L16-L181)

## Module Detection and Management

The build system automatically discovers and configures modules through a standardized discovery process that supports both built-in and custom modules.

```mermaid
graph TB
    subgraph "Module Discovery Process"
        detect_modules["methods.detect_modules()<br/>Module Discovery<br/>Lines 234-294"]
        module_search["module_search_paths<br/>Search Locations"]
        is_module["methods.is_module()<br/>Module Validation<br/>Lines 297-304"]
        module_config["config.py<br/>Module Configuration"]
    end
    
    subgraph "Module Requirements"
        register_types["register_types.h<br/>Type Registration"]
        scsub_file["SCsub<br/>Build Script"]
        config_py["config.py<br/>Configuration"]
    end
    
    subgraph "Module Integration"
        modules_enabled["modules_enabled.gen.h<br/>Generated Defines"]
        register_module_types["register_module_types.gen.cpp<br/>Generated Registration"]
        module_libraries["libmodule_<name>.a<br/>Static Libraries"]
    end
    
    detect_modules --> module_search
    module_search --> is_module
    is_module --> register_types
    is_module --> scsub_file
    is_module --> config_py
    
    module_config --> modules_enabled
    module_config --> register_module_types
    module_config --> module_libraries
```

The module system uses three required files for each module:
- `register_types.h` - Module type registration interface
- `SCsub` - Module-specific build configuration
- `config.py` - Module options and dependencies

Sources: [methods.py:234-304](https://github.com/godotengine/godot/blob/4219ce91/methods.py#L234-L304), [SConstruct:392-449](https://github.com/godotengine/godot/blob/4219ce91/SConstruct#L392-L449), [modules/SCsub:1-64](https://github.com/godotengine/godot/blob/4219ce91/modules/SCsub#L1-L64), [modules/modules_builders.py:8-61](https://github.com/godotengine/godot/blob/4219ce91/modules/modules_builders.py#L8-L61)

## Source File Handling and SCU Builds

The build system provides flexible source file management with support for Single Compilation Unit (SCU) builds for faster compilation.

```mermaid
graph TB
    subgraph "Source File Processing"
        add_source_files["env.add_source_files()<br/>Primary Interface<br/>methods.py:78-83"]
        scu_check["add_source_files_scu()<br/>SCU Build Check<br/>methods.py:53-73"]
        orig_add["add_source_files_orig()<br/>Regular Build<br/>methods.py:34-50"]
    end
    
    subgraph "SCU Build System"
        scu_folders["_scu_folders<br/>SCU-enabled Directories"]
        scu_gen_files[".scu/scu_*.gen.cpp<br/>Generated SCU Files"]
        scu_builders["scu_builders.py<br/>SCU File Generation"]
    end
    
    subgraph "Build Optimization"
        redirect_emitter["redirect_emitter()<br/>Object Redirection<br/>methods.py:86-106"]
        bin_obj["bin/obj/<br/>Centralized Objects"]
    end
    
    add_source_files --> scu_check
    scu_check --> scu_folders
    scu_folders --> scu_gen_files
    scu_check --> orig_add
    
    orig_add --> redirect_emitter
    redirect_emitter --> bin_obj
```

The SCU build system improves compilation performance by combining multiple source files into single compilation units, controlled by the `scu_build` option and `scu_limit` setting.

Sources: [methods.py:34-83](https://github.com/godotengine/godot/blob/4219ce91/methods.py#L34-L83), [methods.py:86-106](https://github.com/godotengine/godot/blob/4219ce91/methods.py#L86-L106), [SConstruct:635-646](https://github.com/godotengine/godot/blob/4219ce91/SConstruct#L635-L646)

## Build Configuration and Target Types

The build system supports multiple build configurations and target types with extensive customization options.

```mermaid
graph TB
    subgraph "Build Targets"
        editor_build["env.editor_build<br/>Editor Target"]
        template_debug["template_debug<br/>Debug Runtime"]
        template_release["template_release<br/>Release Runtime"] 
    end
    
    subgraph "Build Features"
        dev_build["env.dev_build<br/>Developer Features"]
        debug_features["env.debug_features<br/>Debug Code"]
        optimization["env['optimize']<br/>Optimization Level"]
    end
    
    subgraph "Platform Features"
        vulkan_enabled["vulkan<br/>Vulkan Renderer"]
        opengl3_enabled["opengl3<br/>OpenGL ES 3.0"]
        d3d12_enabled["d3d12<br/>Direct3D 12"]
        metal_enabled["metal<br/>Metal Renderer"]
    end
    
    subgraph "Generated Configuration"
        version_gen["version_generated.gen.h<br/>Version Information"]
        disabled_classes["disabled_classes.gen.h<br/>Feature Exclusions"]
        certs_compressed["certs_compressed.gen.h<br/>SSL Certificates"]
    end
    
    editor_build --> dev_build
    template_debug --> debug_features
    template_release --> optimization
    
    vulkan_enabled --> version_gen
    opengl3_enabled --> disabled_classes
    d3d12_enabled --> certs_compressed
```

Key build configuration variables:

| Variable | Purpose | Values |
|----------|---------|--------|
| `target` | Build target type | `editor`, `template_debug`, `template_release` |
| `arch` | Target architecture | `x86_32`, `x86_64`, `arm32`, `arm64` |
| `optimize` | Optimization level | `none`, `debug`, `speed`, `speed_trace`, `size` |
| `lto` | Link-time optimization | `none`, `auto`, `thin`, `full` |

Sources: [SConstruct:160-186](https://github.com/godotengine/godot/blob/4219ce91/SConstruct#L160-L186), [SConstruct:492-522](https://github.com/godotengine/godot/blob/4219ce91/SConstruct#L492-L522), [core/SCsub:169-217](https://github.com/godotengine/godot/blob/4219ce91/core/SCsub#L169-L217), [core/core_builders.py:17-46](https://github.com/godotengine/godot/blob/4219ce91/core/core_builders.py#L17-L46)

## Code Generation and Builder System

The build system includes extensive code generation capabilities for creating headers, registration code, and resource embedding through builder functions.

```mermaid
graph TB
    subgraph "Core Builders"
        version_builder["version_info_builder<br/>Version Headers"]
        hash_builder["version_hash_builder<br/>Git Information"]
        certs_builder["make_certs_header<br/>SSL Certificates"]
        authors_builder["make_authors_header<br/>Credits"]
    end
    
    subgraph "Editor Builders"
        doc_builder["make_doc_header<br/>Documentation"]
        translation_builder["make_translations_header<br/>Localization"]
        icon_builder["make_editor_icons_action<br/>SVG Processing"]
        exporter_builder["register_exporters_builder<br/>Platform Exporters"]
    end
    
    subgraph "Module Builders"
        module_enabled["modules_enabled_builder<br/>Module Defines"]
        module_register["register_module_types_builder<br/>Module Registration"]
        module_tests["modules_tests_builder<br/>Test Integration"]
    end
    
    subgraph "Generated Files"
        gen_headers[".gen.h Files<br/>Generated Headers"]
        gen_sources[".gen.cpp Files<br/>Generated Sources"]
    end
    
    version_builder --> gen_headers
    doc_builder --> gen_headers
    module_enabled --> gen_headers
    
    hash_builder --> gen_sources
    exporter_builder --> gen_sources
    module_register --> gen_sources
```

Builder functions use `env.CommandNoCache()` to generate source files during the build process, ensuring proper dependency tracking and incremental builds.